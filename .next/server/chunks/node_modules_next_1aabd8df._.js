module.exports=[30240,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{MutableRequestCookiesAdapter:function(){return l},ReadonlyRequestCookiesError:function(){return s},RequestCookiesAdapter:function(){return i},appendMutableCookies:function(){return d},areCookiesMutableInCurrentPhase:function(){return f},createCookiesWithMutableAccessCheck:function(){return p},getModifiedCookieValues:function(){return u},responseCookiesToRequestCookies:function(){return b}});let n=e.r(472),a=e.r(30759),o=e.r(56704);class s extends Error{constructor(){super("Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#options")}static callable(){throw new s}}class i{static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"clear":case"delete":case"set":return s.callable;default:return a.ReflectAdapter.get(e,t,r)}}})}}let c=Symbol.for("next.mutated.cookies");function u(e){let t=e[c];return t&&Array.isArray(t)&&0!==t.length?t:[]}function d(e,t){let r=u(t);if(0===r.length)return!1;let a=new n.ResponseCookies(e),o=a.getAll();for(let e of r)a.set(e);for(let e of o)a.set(e);return!0}class l{static wrap(e,t){let r=new n.ResponseCookies(new Headers);for(let t of e.getAll())r.set(t);let s=[],i=new Set,u=()=>{let e=o.workAsyncStorage.getStore();if(e&&(e.pathWasRevalidated=!0),s=r.getAll().filter(e=>i.has(e.name)),t){let e=[];for(let t of s){let r=new n.ResponseCookies(new Headers);r.set(t),e.push(r.toString())}t(e)}},d=new Proxy(r,{get(e,t,r){switch(t){case c:return s;case"delete":return function(...t){i.add("string"==typeof t[0]?t[0]:t[0].name);try{return e.delete(...t),d}finally{u()}};case"set":return function(...t){i.add("string"==typeof t[0]?t[0]:t[0].name);try{return e.set(...t),d}finally{u()}};default:return a.ReflectAdapter.get(e,t,r)}}});return d}}function p(e){let t=new Proxy(e.mutableCookies,{get(r,n,o){switch(n){case"delete":return function(...n){return h(e,"cookies().delete"),r.delete(...n),t};case"set":return function(...n){return h(e,"cookies().set"),r.set(...n),t};default:return a.ReflectAdapter.get(r,n,o)}}});return t}function f(e){return"action"===e.phase}function h(e,t){if(!f(e))throw new s}function b(e){let t=new n.RequestCookies(new Headers);for(let r of e.getAll())t.set(r);return t}},13884,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"createDedupedByCallsiteServerErrorLoggerDev",{enumerable:!0,get:function(){return c}});let n=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var i=o?Object.getOwnPropertyDescriptor(e,s):null;i&&(i.get||i.set)?Object.defineProperty(n,s,i):n[s]=e[s]}return n.default=e,r&&r.set(e,n),n}(e.r(47540));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}let o={current:null},s="function"==typeof n.cache?n.cache:e=>e,i=console.warn;function c(e){return function(...t){i(e(...t))}}s(e=>{try{i(o.current)}finally{o.current=null}})},7460,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"cookies",{enumerable:!0,get:function(){return f}});let n=e.r(30240),a=e.r(472),o=e.r(56704),s=e.r(32319),i=e.r(68665),c=e.r(97573),u=e.r(4642),d=e.r(13884),l=e.r(43824),p=e.r(76414);function f(){let e="cookies",t=o.workAsyncStorage.getStore(),r=s.workUnitAsyncStorage.getStore();if(t){if(r&&"after"===r.phase&&!(0,l.isRequestAPICallableInsideAfter)())throw Object.defineProperty(Error(`Route ${t.route} used "cookies" inside "after(...)". This is not supported. If you need this data inside an "after" callback, use "cookies" outside of the callback. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E88",enumerable:!1,configurable:!0});if(t.forceStatic)return b(n.RequestCookiesAdapter.seal(new a.RequestCookies(new Headers({}))));if(t.dynamicShouldError)throw Object.defineProperty(new c.StaticGenBailoutError(`Route ${t.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`cookies\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E549",enumerable:!1,configurable:!0});if(r)switch(r.type){case"cache":let o=Object.defineProperty(Error(`Route ${t.route} used "cookies" inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use "cookies" outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E398",enumerable:!1,configurable:!0});throw Error.captureStackTrace(o,f),t.invalidDynamicUsageError??=o,o;case"unstable-cache":throw Object.defineProperty(Error(`Route ${t.route} used "cookies" inside a function cached with "unstable_cache(...)". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use "cookies" outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E157",enumerable:!1,configurable:!0});case"prerender":var d=t,g=r;let s=h.get(g);if(s)return s;let y=(0,u.makeHangingPromise)(g.renderSignal,d.route,"`cookies()`");return h.set(g,y),y;case"prerender-client":let m="`cookies`";throw Object.defineProperty(new p.InvariantError(`${m} must not be used within a client component. Next.js should be preventing ${m} from being included in client components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E693",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,i.postponeWithTracking)(t.route,e,r.dynamicTracking);case"prerender-legacy":return(0,i.throwToInterruptStaticGeneration)(e,t,r);case"prerender-runtime":return(0,i.delayUntilRuntimeStage)(r,function(e){let t=h.get(e);if(t)return t;let r=Promise.resolve(e);return h.set(e,r),r}(r.cookies));case"private-cache":return b(r.cookies);case"request":return(0,i.trackDynamicDataInDynamicRender)(r),b((0,n.areCookiesMutableInCurrentPhase)(r)?r.userspaceMutableCookies:r.cookies)}}(0,s.throwForMissingRequestStore)(e)}e.r(30759);let h=new WeakMap;function b(e){let t=h.get(e);if(t)return t;let r=Promise.resolve(e);return h.set(e,r),Object.defineProperties(r,{[Symbol.iterator]:{value:e[Symbol.iterator]?e[Symbol.iterator].bind(e):g.bind(e)},size:{get:()=>e.size},get:{value:e.get.bind(e)},getAll:{value:e.getAll.bind(e)},has:{value:e.has.bind(e)},set:{value:e.set.bind(e)},delete:{value:e.delete.bind(e)},clear:{value:"function"==typeof e.clear?e.clear.bind(e):y.bind(e,r)},toString:{value:e.toString.bind(e)}}),r}function g(){return this.getAll().map(e=>[e.name,e]).values()}function y(e){for(let e of this.getAll())this.delete(e.name);return e}(0,d.createDedupedByCallsiteServerErrorLoggerDev)(function(e,t){let r=e?`Route "${e}" `:"This route ";return Object.defineProperty(Error(`${r}used ${t}. \`cookies()\` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E223",enumerable:!1,configurable:!0})})},36052,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{HeadersAdapter:function(){return o},ReadonlyHeadersError:function(){return a}});let n=e.r(30759);class a extends Error{constructor(){super("Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers")}static callable(){throw new a}}class o extends Headers{constructor(e){super(),this.headers=new Proxy(e,{get(t,r,a){if("symbol"==typeof r)return n.ReflectAdapter.get(t,r,a);let o=r.toLowerCase(),s=Object.keys(e).find(e=>e.toLowerCase()===o);if(void 0!==s)return n.ReflectAdapter.get(t,s,a)},set(t,r,a,o){if("symbol"==typeof r)return n.ReflectAdapter.set(t,r,a,o);let s=r.toLowerCase(),i=Object.keys(e).find(e=>e.toLowerCase()===s);return n.ReflectAdapter.set(t,i??r,a,o)},has(t,r){if("symbol"==typeof r)return n.ReflectAdapter.has(t,r);let a=r.toLowerCase(),o=Object.keys(e).find(e=>e.toLowerCase()===a);return void 0!==o&&n.ReflectAdapter.has(t,o)},deleteProperty(t,r){if("symbol"==typeof r)return n.ReflectAdapter.deleteProperty(t,r);let a=r.toLowerCase(),o=Object.keys(e).find(e=>e.toLowerCase()===a);return void 0===o||n.ReflectAdapter.deleteProperty(t,o)}})}static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"append":case"delete":case"set":return a.callable;default:return n.ReflectAdapter.get(e,t,r)}}})}merge(e){return Array.isArray(e)?e.join(", "):e}static from(e){return e instanceof Headers?e:new o(e)}append(e,t){let r=this.headers[e];"string"==typeof r?this.headers[e]=[r,t]:Array.isArray(r)?r.push(t):this.headers[e]=t}delete(e){delete this.headers[e]}get(e){let t=this.headers[e];return void 0!==t?this.merge(t):null}has(e){return void 0!==this.headers[e]}set(e,t){this.headers[e]=t}forEach(e,t){for(let[r,n]of this.entries())e.call(t,n,r,this)}*entries(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase(),r=this.get(t);yield[t,r]}}*keys(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase();yield t}}*values(){for(let e of Object.keys(this.headers)){let t=this.get(e);yield t}}[Symbol.iterator](){return this.entries()}}},19971,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"headers",{enumerable:!0,get:function(){return p}});let n=e.r(36052),a=e.r(56704),o=e.r(32319),s=e.r(68665),i=e.r(97573),c=e.r(4642),u=e.r(13884),d=e.r(43824),l=e.r(76414);function p(){let e="headers",t=a.workAsyncStorage.getStore(),r=o.workUnitAsyncStorage.getStore();if(t){if(r&&"after"===r.phase&&!(0,d.isRequestAPICallableInsideAfter)())throw Object.defineProperty(Error(`Route ${t.route} used "headers" inside "after(...)". This is not supported. If you need this data inside an "after" callback, use "headers" outside of the callback. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E367",enumerable:!1,configurable:!0});if(t.forceStatic)return h(n.HeadersAdapter.seal(new Headers({})));if(r)switch(r.type){case"cache":{let e=Object.defineProperty(Error(`Route ${t.route} used "headers" inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use "headers" outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E304",enumerable:!1,configurable:!0});throw Error.captureStackTrace(e,p),t.invalidDynamicUsageError??=e,e}case"private-cache":{let e=Object.defineProperty(Error(`Route ${t.route} used "headers" inside "use cache: private". Accessing "headers" inside a private cache scope is not supported. If you need this data inside a cached function use "headers" outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E742",enumerable:!1,configurable:!0});throw Error.captureStackTrace(e,p),t.invalidDynamicUsageError??=e,e}case"unstable-cache":throw Object.defineProperty(Error(`Route ${t.route} used "headers" inside a function cached with "unstable_cache(...)". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use "headers" outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E127",enumerable:!1,configurable:!0})}if(t.dynamicShouldError)throw Object.defineProperty(new i.StaticGenBailoutError(`Route ${t.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`headers\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E525",enumerable:!1,configurable:!0});if(r)switch(r.type){case"prerender":case"prerender-runtime":var u=t,b=r;let a=f.get(b);if(a)return a;let o=(0,c.makeHangingPromise)(b.renderSignal,u.route,"`headers()`");return f.set(b,o),o;case"prerender-client":let g="`headers`";throw Object.defineProperty(new l.InvariantError(`${g} must not be used within a client component. Next.js should be preventing ${g} from being included in client components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E693",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,s.postponeWithTracking)(t.route,e,r.dynamicTracking);case"prerender-legacy":return(0,s.throwToInterruptStaticGeneration)(e,t,r);case"request":return(0,s.trackDynamicDataInDynamicRender)(r),h(r.headers)}}(0,o.throwForMissingRequestStore)(e)}e.r(30759);let f=new WeakMap;function h(e){let t=f.get(e);if(t)return t;let r=Promise.resolve(e);return f.set(e,r),Object.defineProperties(r,{append:{value:e.append.bind(e)},delete:{value:e.delete.bind(e)},get:{value:e.get.bind(e)},has:{value:e.has.bind(e)},set:{value:e.set.bind(e)},getSetCookie:{value:e.getSetCookie.bind(e)},forEach:{value:e.forEach.bind(e)},keys:{value:e.keys.bind(e)},values:{value:e.values.bind(e)},entries:{value:e.entries.bind(e)},[Symbol.iterator]:{value:e[Symbol.iterator].bind(e)}}),r}(0,u.createDedupedByCallsiteServerErrorLoggerDev)(function(e,t){let r=e?`Route "${e}" `:"This route ";return Object.defineProperty(Error(`${r}used ${t}. \`headers()\` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E277",enumerable:!1,configurable:!0})})},21423,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"draftMode",{enumerable:!0,get:function(){return d}});let n=e.r(32319),a=e.r(56704),o=e.r(68665),s=e.r(13884),i=e.r(97573),c=e.r(65252),u=e.r(76414);function d(){let e=a.workAsyncStorage.getStore(),t=n.workUnitAsyncStorage.getStore();switch((!e||!t)&&(0,n.throwForMissingRequestStore)("draftMode"),t.type){case"prerender-runtime":return(0,o.delayUntilRuntimeStage)(t,l(t.draftMode,e));case"request":return l(t.draftMode,e);case"cache":case"private-cache":case"unstable-cache":let r=(0,n.getDraftModeProviderForCacheScope)(e,t);if(r)return l(r,e);case"prerender":case"prerender-client":case"prerender-ppr":case"prerender-legacy":return l(null,e);default:return t}}function l(e,t){let r,n=e??p,a=f.get(n);return a||(r=function(e){let t=new h(e),r=Promise.resolve(t);return Object.defineProperty(r,"isEnabled",{get:()=>t.isEnabled,enumerable:!0,configurable:!0}),r.enable=t.enable.bind(t),r.disable=t.disable.bind(t),r}(e),f.set(n,r),r)}e.r(30759);let p={},f=new WeakMap;class h{constructor(e){this._provider=e}get isEnabled(){return null!==this._provider&&this._provider.isEnabled}enable(){b("draftMode().enable()",this.enable),null!==this._provider&&this._provider.enable()}disable(){b("draftMode().disable()",this.disable),null!==this._provider&&this._provider.disable()}}function b(e,t){let r=a.workAsyncStorage.getStore(),s=n.workUnitAsyncStorage.getStore();if(r){if((null==s?void 0:s.phase)==="after")throw Object.defineProperty(Error(`Route ${r.route} used "${e}" inside \`after\`. The enabled status of draftMode can be read inside \`after\` but you cannot enable or disable draftMode. See more info here: https://nextjs.org/docs/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E348",enumerable:!1,configurable:!0});if(r.dynamicShouldError)throw Object.defineProperty(new i.StaticGenBailoutError(`Route ${r.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`${e}\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E553",enumerable:!1,configurable:!0});if(s)switch(s.type){case"cache":case"private-cache":{let n=Object.defineProperty(Error(`Route ${r.route} used "${e}" inside "use cache". The enabled status of draftMode can be read in caches but you must not enable or disable draftMode inside a cache. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E246",enumerable:!1,configurable:!0});throw Error.captureStackTrace(n,t),r.invalidDynamicUsageError??=n,n}case"unstable-cache":throw Object.defineProperty(Error(`Route ${r.route} used "${e}" inside a function cached with "unstable_cache(...)". The enabled status of draftMode can be read in caches but you must not enable or disable draftMode inside a cache. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E259",enumerable:!1,configurable:!0});case"prerender":case"prerender-runtime":{let t=Object.defineProperty(Error(`Route ${r.route} used ${e} without first calling \`await connection()\`. See more info here: https://nextjs.org/docs/messages/next-prerender-sync-headers`),"__NEXT_ERROR_CODE",{value:"E126",enumerable:!1,configurable:!0});return(0,o.abortAndThrowOnSynchronousRequestDataAccess)(r.route,e,t,s)}case"prerender-client":let n="`draftMode`";throw Object.defineProperty(new u.InvariantError(`${n} must not be used within a client component. Next.js should be preventing ${n} from being included in client components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E693",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,o.postponeWithTracking)(r.route,e,s.dynamicTracking);case"prerender-legacy":s.revalidate=0;let a=Object.defineProperty(new c.DynamicServerError(`Route ${r.route} couldn't be rendered statically because it used \`${e}\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E558",enumerable:!1,configurable:!0});throw r.dynamicUsageDescription=e,r.dynamicUsageStack=a.stack,a;case"request":(0,o.trackDynamicDataInDynamicRender)(s)}}}(0,s.createDedupedByCallsiteServerErrorLoggerDev)(function(e,t){let r=e?`Route "${e}" `:"This route ";return Object.defineProperty(Error(`${r}used ${t}. \`draftMode()\` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E377",enumerable:!1,configurable:!0})})},93458,(e,t,r)=>{t.exports.cookies=e.r(7460).cookies,t.exports.headers=e.r(19971).headers,t.exports.draftMode=e.r(21423).draftMode},83872,e=>{"use strict";e.s(["handler",()=>A,"patchFetch",()=>C,"routeModule",()=>_,"serverHooks",()=>S,"workAsyncStorage",()=>k,"workUnitAsyncStorage",()=>O],83872);var t=e.i(47909),r=e.i(74017),n=e.i(96250),a=e.i(59756),o=e.i(61916),s=e.i(69741),i=e.i(16795),c=e.i(87718),u=e.i(95169),d=e.i(47587),l=e.i(66012),p=e.i(70101),f=e.i(26937),h=e.i(10372),b=e.i(93695);e.i(52474);var g=e.i(220);e.s(["POST",()=>w],7596);var y=e.i(89171),m=e.i(93458);async function R(e,t,r,n){let a=await fetch(n,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","x-api-key":r,Host:"stage.ema-api.com"},body:new URLSearchParams({grant_type:"password",username:e,password:t})});if(console.log("Auth response status:",a.status),!a.ok){let e=await a.text();throw Error(`Auth failed: ${a.status} - ${e}`)}let o=await a.json();return{accessToken:o.access_token,refreshToken:o.refresh_token,expiresIn:o.expires_in||3600}}async function E(e,t,r){let n=await fetch(r,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","x-api-key":t,Host:"stage.ema-api.com"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:e})});if(!n.ok)throw Error(`Refresh failed: ${n.status}`);let a=await n.json();return{accessToken:a.access_token,refreshToken:a.refresh_token||e,expiresIn:a.expires_in||3600}}async function w(e){try{let t,{username:r,password:n,action:a}=await e.json(),o=process.env.MODMED_FIRM_PREFIX,s=process.env.MODMED_API_KEY,i=`https://stage.ema-api.com/ema-dev/firm/${o}/ema/ws/oauth2/grant`;if(!o||!s)throw Error("Missing firm prefix or API key in server configuration");if("refresh"===a){let e=(await (0,m.cookies)()).get("modmed_refresh")?.value;if(!e)throw Error("No refresh token available");t=await E(e,s,i)}else{if(!r||!n)throw Error("Missing username or password");t=await R(r,n,s,i)}let c={httpOnly:!0,secure:!0,sameSite:"strict",maxAge:t.expiresIn};return(await (0,m.cookies)()).set("modmed_access",t.accessToken,c),(await (0,m.cookies)()).set("modmed_refresh",t.refreshToken,{...c,maxAge:604800}),y.NextResponse.json({success:!0,expiresIn:t.expiresIn})}catch(e){return console.error("Auth error:",e),y.NextResponse.json({error:e.message},{status:e.message.includes("Auth failed")?401:400})}}var v=e.i(7596);let _=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/modmed/route",pathname:"/api/modmed",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/modmed/route.ts",nextConfigOutput:"",userland:v}),{workAsyncStorage:k,workUnitAsyncStorage:O,serverHooks:S}=_;function C(){return(0,n.patchFetch)({workAsyncStorage:k,workUnitAsyncStorage:O})}async function A(e,t,n){var y;let m="/api/modmed/route";m=m.replace(/\/index$/,"")||"/";let R=await _.prepare(e,t,{srcPage:m,multiZoneDraftMode:!1});if(!R)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:E,params:w,nextConfig:v,isDraftMode:k,prerenderManifest:O,routerServerContext:S,isOnDemandRevalidate:C,revalidateOnlyGenerated:A,resolvedPathname:P}=R,x=(0,s.normalizeAppPath)(m),j=!!(O.dynamicRoutes[x]||O.routes[P]);if(j&&!k){let e=!!O.routes[P],t=O.dynamicRoutes[x];if(t&&!1===t.fallback&&!e)throw new b.NoFallbackError}let T=null;!j||_.isDev||k||(T="/index"===(T=P)?"/":T);let D=!0===_.isDev||!j,M=j&&!D,N=e.method||"GET",$=(0,o.getTracer)(),I=$.getActiveScopeSpan(),q={params:w,prerenderManifest:O,renderOpts:{experimental:{cacheComponents:!!v.experimental.cacheComponents,authInterrupts:!!v.experimental.authInterrupts},supportsDynamicResponse:D,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:null==(y=v.experimental)?void 0:y.cacheLife,isRevalidate:M,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n)=>_.onRequestError(e,t,n,S)},sharedContext:{buildId:E}},H=new i.NodeNextRequest(e),U=new i.NodeNextResponse(t),X=c.NextRequestAdapter.fromNodeNextRequest(H,(0,c.signalFromNodeResponse)(t));try{let s=async r=>_.handle(X,q).finally(()=>{if(!r)return;r.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let n=$.getRootSpanAttributes();if(!n)return;if(n.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${n.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=n.get("next.route");if(a){let e=`${N} ${a}`;r.setAttributes({"next.route":a,"http.route":a,"next.span_name":e}),r.updateName(e)}else r.updateName(`${N} ${e.url}`)}),i=async o=>{var i,c;let u=async({previousCacheEntry:r})=>{try{if(!(0,a.getRequestMeta)(e,"minimalMode")&&C&&A&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await s(o);e.fetchMetrics=q.renderOpts.fetchMetrics;let c=q.renderOpts.pendingWaitUntil;c&&n.waitUntil&&(n.waitUntil(c),c=void 0);let u=q.renderOpts.collectedTags;if(!j)return await (0,l.sendResponse)(H,U,i,q.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,p.toNodeOutgoingHttpHeaders)(i.headers);u&&(t[h.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==q.renderOpts.collectedRevalidate&&!(q.renderOpts.collectedRevalidate>=h.INFINITE_CACHE)&&q.renderOpts.collectedRevalidate,n=void 0===q.renderOpts.collectedExpire||q.renderOpts.collectedExpire>=h.INFINITE_CACHE?void 0:q.renderOpts.collectedExpire;return{value:{kind:g.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==r?void 0:r.isStale)&&await _.onRequestError(e,t,{routerKind:"App Router",routePath:m,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isRevalidate:M,isOnDemandRevalidate:C})},S),t}},b=await _.handleResponse({req:e,nextConfig:v,cacheKey:T,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:O,isRoutePPREnabled:!1,isOnDemandRevalidate:C,revalidateOnlyGenerated:A,responseGenerator:u,waitUntil:n.waitUntil});if(!j)return null;if((null==b||null==(i=b.value)?void 0:i.kind)!==g.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==b||null==(c=b.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,a.getRequestMeta)(e,"minimalMode")||t.setHeader("x-nextjs-cache",C?"REVALIDATED":b.isMiss?"MISS":b.isStale?"STALE":"HIT"),k&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let y=(0,p.fromNodeOutgoingHttpHeaders)(b.value.headers);return(0,a.getRequestMeta)(e,"minimalMode")&&j||y.delete(h.NEXT_CACHE_TAGS_HEADER),!b.cacheControl||t.getHeader("Cache-Control")||y.get("Cache-Control")||y.set("Cache-Control",(0,f.getCacheControlHeader)(b.cacheControl)),await (0,l.sendResponse)(H,U,new Response(b.value.body,{headers:y,status:b.value.status||200})),null};I?await i(I):await $.withPropagatedContext(e.headers,()=>$.trace(u.BaseServerSpan.handleRequest,{spanName:`${N} ${e.url}`,kind:o.SpanKind.SERVER,attributes:{"http.method":N,"http.target":e.url}},i))}catch(t){if(I||t instanceof b.NoFallbackError||await _.onRequestError(e,t,{routerKind:"App Router",routePath:x,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isRevalidate:M,isOnDemandRevalidate:C})}),j)throw t;return await (0,l.sendResponse)(H,U,new Response(null,{status:500})),null}}}];

//# sourceMappingURL=node_modules_next_1aabd8df._.js.map